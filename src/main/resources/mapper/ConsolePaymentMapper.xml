<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.kok.mapper.ConsolePaymentMapper">
    <select id="selectPaymentByCompany">
        select
            a.advertisement_main_text,
            p.payment_price,
            p.payment_paid_datetime,
            p.payment_status
        from tbl_payment_user pu
            join tbl_payment p
                on pu.payment_id = p.id
            join tbl_advertisement a
                on pu.advertisement_id = a.id
        where pu.user_id = #{companyId}
        order by p.payment_paid_datetime desc
        limit #{criteria.count} offset #{criteria.offset}
    </select>

    <select id="selectCountByCompany">
        select count(distinct pu.id)
        from tbl_payment_user pu
                 join tbl_payment p
                      on pu.payment_id = p.id
                 join tbl_advertisement a
                      on pu.advertisement_id = a.id
        where pu.user_id = #{companyId}
    </select>
</mapper>